# Issue 03.1.1: Core Player Interface and Mini-Player

**GitHub Issue**: [#107](https://github.com/ezigus/zpod/issues/107)

## Priority
High


## Status
âœ… Complete (2025-12-27)

**Note:** This issue is now fully implemented and closed on GitHub ([#107](https://github.com/ezigus/zpod/issues/107)). All acceptance criteria and sub-issues are complete. See dev-log and sub-issues for test and implementation details.

**Scope Update (2026-01):** The player UX is evolving to use a collapsed mini-player pill by default and to show the full player directly in the Player tab. Track the updated behavior in `03.1.1.6-mini-player-pill-reveal` and `03.1.1.7-player-tab-full-player`.

## Description
Implement the fundamental player interface including mini-player navigation bar integration and basic expanded player view with essential playback controls.

## Acceptance Criteria

### Given/When/Then Scenarios

#### Scenario 1: Mini-Player Interface
- **Given** An episode is playing or paused
- **When** I navigate away from the player tab
- **Then** A mini-player should appear at the bottom of the screen
- **And** The mini-player should show episode title, podcast name, and artwork
- **And** I should be able to play/pause and skip forward/backward from the mini-player
- **And** Tapping the mini-player should expand to the full player interface
- **And** Mini-player should persist across app navigation and maintain playback state

#### Scenario 2: Expanded Player Interface with Essential Controls
- **Given** I am in the full player view
- **When** I view the player interface
- **Then** I should see large episode artwork, full metadata, and comprehensive controls
- **And** I should see a progress slider with current time, total duration, and basic navigation
- **And** I should have access to essential playback controls: play/pause, skip forward/back
- **And** All controls should provide haptic feedback and visual state changes
- **And** Player should integrate with Control Center and lock screen controls

#### Scenario 3: Playback State Management and Persistence
- **Given** I am using the player interface
- **When** I interact with playback controls or switch between mini and full player
- **Then** Playback state should remain consistent across all interface transitions
- **And** Current position should be preserved accurately during app backgrounding
- **And** Player state should sync immediately between mini-player and full interface
- **And** Resume playback should work correctly after app restart

#### Scenario 4: Visual Design and Responsive Layout
- **Given** I am using the player on different device sizes and orientations
- **When** I rotate the device or use iPad split screen
- **Then** Player interface should adapt responsively to different screen sizes
- **And** Artwork should scale appropriately while maintaining aspect ratio
- **And** Controls should remain accessible and properly sized on all devices
- **And** Interface should follow iOS design guidelines and accessibility standards

## Implementation Approach

### Phase 1: Mini-Player Foundation (Week 1)
1. **Mini-Player Implementation**
   - Create persistent mini-player that appears during playback
   - Implement slide-up animation and gesture recognition for expansion
   - Add basic controls: play/pause, skip forward/back, artwork display
   - Create proper navigation integration that doesn't interfere with tab switching

2. **Core Playback Integration**
   - Connect mini-player to playback engine with real-time state updates
   - Implement playback state persistence across app navigation
   - Add proper audio session management and background playback
   - Create Control Center and lock screen integration

### Phase 2: Expanded Player Interface (Week 2)
1. **Full Player View**
   - Create expanded player interface with large artwork and metadata display
   - Implement smooth transition animations between mini and full player
   - Add comprehensive playback controls with proper spacing and accessibility
   - Create progress slider with accurate position tracking and scrubbing

2. **Responsive Design and Polish**
   - Implement responsive layout for iPhone and iPad form factors
   - Add proper orientation change handling and animation
   - Create visual polish with smooth animations and haptic feedback
   - Implement accessibility features including VoiceOver support

## Specification References
- `playback.md`: Core playback interface requirements and control patterns
- `ui.md`: Player interface design patterns and iOS integration
- `accessibility.md`: Player accessibility and assistive technology support

## Dependencies
- **Required**: Issue #03 (Playback engine backend functionality)
- **Required**: AVAudioSession and MediaPlayer frameworks
- **Recommended**: Haptic feedback framework

## Estimated Effort
**Complexity**: Medium  
**Time Estimate**: 2 weeks  
**Story Points**: 8

## Success Metrics
- Mini-player appears within 500ms of playback start
- Smooth 60fps animations during player transitions
- Playback state remains accurate during interface changes
- Zero crashes during player navigation and state changes

## Sub-Issues
- [#108](https://github.com/ezigus/zpod/issues/108) / `03.1.1.1-mini-player-foundation`
- [#109](https://github.com/ezigus/zpod/issues/109) / `03.1.1.2-expanded-player-layout`
- [#110](https://github.com/ezigus/zpod/issues/110) / `03.1.1.3-playback-state-synchronization`
- [#111](https://github.com/ezigus/zpod/issues/111) / `03.1.1.4-system-media-integration`

## Testing Strategy
- **Unit Tests**: Player state management and control logic
- **Integration Tests**: Playback engine integration and audio session handling
- **UI Tests**: Player navigation and control interaction
- **Performance Tests**: Animation performance and memory usage during playback

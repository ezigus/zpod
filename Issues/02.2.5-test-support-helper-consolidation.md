# Issue 02.2.5: TestSupport Helper Consolidation (Siri Snapshot Tests)

**Status**: Open
**Priority**: P2 - Medium
**Created**: 2026-01-17
**Category**: Test Infrastructure

## Description
Consolidate duplicated test helpers used by Siri snapshot and persistence tests into `TestSupport` so AppSmoke and Integration suites share the same fixtures and utilities.

## Problem Statement
Test-only helpers are currently duplicated across AppSmoke and Integration targets (no-op snapshot refresher, snapshot wait helper, and sample podcast factories). This raises maintenance cost and leads to inconsistent behavior between test suites.

## Acceptance Criteria
- [ ] Add `NoopSiriSnapshotRefresher` to `Packages/TestSupport` and remove local duplicates.
- [ ] Replace the local Siri snapshot spy in `AppSmokeTests/SwiftDataPodcastManagerTests.swift` with `SpySiriSnapshotRefresher` from TestSupport.
- [ ] Add `PodcastFixtures` (podcast + episode factories) to TestSupport and update tests to use it.
- [ ] Add reusable XCTest wait helpers (predicate polling + UserDefaults key wait) to TestSupport.
- [ ] (Optional) Add `IsolatedUserDefaults` helper for suite-name cleanup and update tests to use it where appropriate.
- [ ] Remove duplicate helper implementations from test targets once centralized.
- [ ] Targeted suites pass (`AppSmokeTests`, `IntegrationTests`, `TestSupport`).

## Spec References
- None (test infrastructure consolidation)

## Dependencies
- Related: Issue 27.1.2 (Siri snapshot verification)

## Testing Strategy
- `./scripts/run-xcode-tests.sh -t AppSmokeTests,IntegrationTests,TestSupport`
- `./scripts/run-xcode-tests.sh` (full regression)

## Notes
Keep TestSupport dependency edges minimal; avoid adding helpers that would create circular package dependencies.

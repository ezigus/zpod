# Issue 01.1.1.2: CI Workflow & Environment Integration

## Priority
High

## Status
ðŸ”„ Planned

## Description
Adopt the refactored build script across GitHub Actions, ensure environment abstraction (macOS, Linux), and document the new workflow for contributors.

## Acceptance Criteria

### Scenario 1: CI Workflows Use Shared Script
- **Given** `.github/workflows/ci.yml`
- **When** CI runs syntax checks, unit tests, or UI tests
- **Then** each job invokes `scripts/run-xcode-tests.sh` (with appropriate flags) instead of duplicating xcodebuild/swift commands
- **And** log output is segmented into setup/build/test sections for easier diagnosis

### Scenario 2: Environment Matrix Support
- **Given** the CI pipeline
- **When** macOS and Linux jobs execute
- **Then** macOS jobs run full xcodebuild flows, while Linux jobs automatically fall back to SPM via the new script without manual branching logic in the workflow

### Scenario 3: Documentation & Examples
- **Given** project contributors
- **When** they consult tooling docs (README or `docs/`)
- **Then** they find updated examples for invoking the script locally, including parameter usage (`-b`, `-t`, `--self-check`, etc.)
- **And** guidance is provided for common tasks (full test run, targeted build, cleaning derived data)

### Scenario 4: Legacy Scripts Sunset
- **Given** previous helper scripts or duplicated logic (e.g., `dev-build-enhanced.sh`)
- **When** the new tooling lands
- **Then** either they are updated to call the shared helpers or formally deprecated with README notes, ensuring there is a single blessed entry point for CI and local builds.

## Implementation Approach
1. Update `.github/workflows/ci.yml` (and any other active workflows) to use the refactored script with explicit flags per job.
2. Adjust caching/cleanup steps to leverage script options (`-c`, result bundle directories, etc.).
3. Refresh documentation (`README.md`, `CONTRIBUTING.md`, or new `docs/tooling.md`) explaining usage patterns and environment expectations.
4. Evaluate remaining scripts (`dev-build-enhanced.sh`, etc.) and either wrap them around the new helpers or mark them as deprecated.

## Specification References
- Issue 01.1.1 (parent)
- GitHub Actions workflow standards (`.github/workflows/`)

## Dependencies
- **Required**: Issue 01.1.1.1 â€“ Build Script Core Refactor

## Success Metrics
- CI pipeline passes using only the new script entry point
- Documentation updated and referenced from the repository root
- Contributors can run targeted builds/tests locally with documented commands

## Testing Strategy
- Trial CI runs on a feature branch to validate macOS + Linux matrix execution
- Manual smoke test of scripted commands on a clean checkout (macOS developer machine)
- Validate documentation steps by following them end-to-end

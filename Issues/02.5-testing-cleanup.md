# Issue 02.5: Testing Cleanup

**GitHub Issue**: _To be created_

## Priority
Medium

## Status
ðŸ†• Proposed

## Description
Document and track the work required to align package manifests and code paths so package unit tests execute on macOS runners without being skipped. Several packages (e.g. `PlayerFeature`, `LibraryFeature`) only declare iOS/watchOS platforms and still contain UIKit-specific implementations. This issue captures the refactor plan needed to make those packages platform-neutral (or add viable macOS implementations) so `swift test` runs consistently in CI and produces artifacts instead of skips.

## Acceptance Criteria
- [ ] Update package manifests (PlayerFeature, LibraryFeature, etc.) to include `.macOS(.v14)` once blockers are addressed.
- [ ] Replace or guard UIKit/CarPlay-only code paths with macOS equivalents or cross-platform abstractions.
- [ ] Ensure `swift test` executes successfully for each package on a macOS builder and produces result bundles in `TestResults/`.
- [ ] Update `run-xcode-tests.sh` documentation to note the new behavior and any prerequisites for mac builds.

## Implementation Notes
- Audit `#if os(iOS)` sections in `PlayerFeature` and `LibraryFeature` to identify UI components that need macOS SwiftUI implementations or alternative behavior.
- For tab bar introspection and other UIKit features, consider creating protocol abstractions or conditional shims that are no-ops on macOS but still compile.
- CarPlay setup should be excluded or mocked on macOS builds; wrap in availability checks.
- Coordinate with existing TODOs (e.g. the manifest comment in `PlayerFeature`) to avoid duplication.

## Dependencies
- Issue 03.1.1 (Core player interface) â€“ mini-player/expanded player refactors may overlap.
- Any open issues involving CarPlay or UIKit-specific integrations that are being migrated to shared abstractions.

## Testing Strategy
- Run `./scripts/run-xcode-tests.sh -t <PackageName>` on macOS to confirm `swift test` completes and logs are generated.
- Execute the full regression script and verify package test entries include artifacts rather than skips.


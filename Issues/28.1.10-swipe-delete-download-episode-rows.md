# Issue 28.1.10 - Swipe-to-Delete Download on Episode Rows

**Status:** Open
**Priority:** Medium
**Category:** Download Management / UI
**Created:** 2026-02-07
**Parent Issue:** 28.1
**GitHub Issue:** [#395](https://github.com/ezigus/zpod/issues/395)

## Description

Add swipe-to-delete action on episode rows that removes the local download and reverts the episode to streaming-only. This enables users to free storage on a per-episode basis directly from the episode list.

## Problem Statement

**Current State**:
- Episodes can be downloaded but there is no swipe action to remove the download from the episode list
- The `SwipeAction.delete` identifier is referenced in `OfflinePlaybackUITests.testDeletedDownloadRevertsToStreaming` but the action does not exist in the app
- Users have no per-episode download removal from the episode list view

**Target State**:
- Swipe left on a downloaded episode row reveals a "Delete Download" action
- Tapping the action removes the local file and reverts download status to `.notDownloaded`
- The download badge disappears after deletion
- A confirmation prompt appears before permanent deletion

## Acceptance Criteria

- [ ] Swiping left on a downloaded episode row reveals a delete action with identifier `SwipeAction.delete`
- [ ] Tapping the delete action shows a confirmation dialog
- [ ] Confirming deletion removes the local audio file via `DownloadCoordinator`/`FileManagerService`
- [ ] Episode `downloadStatus` reverts to `.notDownloaded`
- [ ] Download badge disappears from the episode row
- [ ] Non-downloaded episodes do not show the delete-download swipe action
- [ ] VoiceOver announces the swipe action appropriately

## Spec References

- `spec/offline-playback.md` - "Delete download reverts to streaming"
- `spec/download-management.md` - Per-episode download lifecycle

## Dependencies

- Issue 28.1.1 - Download Manager (provides `DownloadCoordinator`)
- Issue 28.1.2 - Local Storage and File Management (provides file deletion)

## Blocked Tests

This issue unblocks the following skipped UI test:
- `OfflinePlaybackUITests.testDeletedDownloadRevertsToStreaming` (currently `XCTSkip`)

## Testing Strategy

### Unit Tests
- Swipe action only appears for downloaded episodes
- Delete action triggers file removal
- Download status updates after deletion

### UI Tests
- `testDeletedDownloadRevertsToStreaming` (currently skipped, un-skip when this issue is complete)

## Estimated Effort

Small-Medium (2-4 hours)

## Files to Modify

| File | Changes |
|------|---------|
| `Packages/LibraryFeature/Sources/LibraryFeature/EpisodeListView.swift` | Add `.swipeActions` modifier with delete-download action |
| `Packages/Networking/Sources/Networking/DownloadCoordinator.swift` | Ensure `deleteDownload(for:)` API exists |
| `zpodUITests/OfflinePlaybackUITests.swift` | Remove `XCTSkip` from `testDeletedDownloadRevertsToStreaming` |
